<!DOCTYPE html>
<head>

    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: transparent;
        }
       #bibleContainer.bible {
            position: absolute;
            bottom: 80px;
            left: 0;
            width: 100%;
            display: flex;
            align-items: stretch; /* This makes the children the same height */
            box-sizing: border-box;
            color: white;
            font-family: Arial, sans-serif;
            opacity: 0;
            transform: translateY(100%);
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }

        #logoContainer {
            background-color: white;
            border-radius: 0; /* No rounded corners */
            padding: 10px;
            flex-shrink: 0;
            display: flex;
            align-items: flex-end; /* Aligns the logo to the bottom of this container */
        }

        #logo {
            width: 110px;
            height: 110px;
            display: block;
        }

        #bibleTextContainer {
            background-color: #224269;
            padding: 20px;
            border-radius: 0; /* No rounded corners */
            display: flex;
            flex-direction: column;
            justify-content: center;
            width: 100%;
        }

        #bibleBook {
            font-size: 38px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        #bibleVerse {
            font-size: 34px;
            line-height: 1.3;
        }
        #speakerContainer.speaker {
            position: absolute;
            bottom: 80px;
            left: 0;
            width: 100%;
            display: flex;
            align-items: stretch;
            box-sizing: border-box;
            color: white;
            font-family: Arial, sans-serif;
            opacity: 0;
            transform: translateY(100%);
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }

        #speakerLogoContainer {
            background-color: white;
            padding: 10px;
            flex-shrink: 0;
            display: flex;
            align-items: flex-end;
        }

        #speakerLogo {
            width: 110px;
            height: 110px;
            display: block;
        }

        #speakerTextContainer {
            background-color: #224269;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
        }

        #speakerName {
            font-size: 70px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
        }
        .visible {
            opacity: 1 !important;
            transform: translateY(0) !important;
        }
    </style>


</head>
<body>
    <div id="bibleContainer" class="bible">
        <div id="logoContainer">
            <img id="logo" src="logoTransparent.png" alt="Logo">
        </div>
        <div id="bibleTextContainer">
            <div id="bibleBook"></div>
            <div id="bibleVerse"></div>
        </div>
    </div>
    
    <div id="speakerContainer" class="speaker">
        <div id="speakerLogoContainer">
            <img id="speakerLogo" src="logoTransparent.png" alt="Logo">
        </div>
        <div id="speakerTextContainer">
            <div id="speakerName">Pastor John</div>
        </div>
    </div>

    <script>
        const ws = new WebSocket('ws://localhost:8080/ws/obs');
        
        ws.onmessage = function(event) {
            const data = JSON.parse(event.data);
            
            if (data.type === 'bible') {
                const bibleElements = document.querySelectorAll('.bible');
                const speakerElements = document.querySelectorAll('.speaker');
                
                if (data.show) {
                    // Hide speaker first if it's visible
                    if (document.querySelector('.speaker.visible')) {
                        speakerElements.forEach(el => el.classList.remove('visible'));
                        setTimeout(() => {
                            document.getElementById('speakerText').textContent = '';
                        }, 1000);
                    }
                    
                    // Set text content first
                    document.getElementById('bibleBook').textContent = data.book || '';
                    document.getElementById('bibleVerse').textContent = data.verse || '';
                    
                    // Show bible verse
                    setTimeout(() => {
                        bibleElements.forEach(el => el.classList.add('visible'));
                    }, 10);
                } else {
                    // Start fade out first
                    bibleElements.forEach(el => el.classList.remove('visible'));
                    // Clear text after fade animation completes (1 second)
                    setTimeout(() => {
                        document.getElementById('bibleBook').textContent = '';
                        document.getElementById('bibleVerse').textContent = '';
                    }, 1000);
                }
            } else if (data.type === 'speaker') {
                const speakerElements = document.querySelectorAll('.speaker');
                const bibleElements = document.querySelectorAll('.bible');
                
                if (data.show) {
                    // Hide bible verse first if it's visible
                    if (document.querySelector('.bible.visible')) {
                        bibleElements.forEach(el => el.classList.remove('visible'));
                        setTimeout(() => {
                            document.getElementById('bibleBook').textContent = '';
                            document.getElementById('bibleVerse').textContent = '';
                        }, 1000);
                    }
                    
                    // Set text content first, then show speaker
                    document.getElementById('speakerName').textContent = data.speaker || '';
                    speakerElements.forEach(el => el.classList.add('visible'));
                } else {
                    // Start fade out first
                    speakerElements.forEach(el => el.classList.remove('visible'));
                    // Clear text after fade animation completes (1 second)
                    setTimeout(() => {
                        document.getElementById('speakerName').textContent = '';
                    }, 1000);
                }
            }
        };
        
        ws.onopen = function() {
            console.log('Connected to server');
        };
        
        ws.onclose = function() {
            console.log('Disconnected from server');
            // Attempt to reconnect after 3 seconds
            setTimeout(() => {
                location.reload();
            }, 3000);
        };
    </script>
</body>
</html>